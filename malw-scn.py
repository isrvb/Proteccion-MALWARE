import clamd

def scan_file(file_path):
    # Conectar al daemon de ClamAV
    clamd_socket = clamd.ClamdUnixSocket()
    clamd_socket.ping()

    # Escanear el archivo
    scan_result = clamd_socket.scan(file_path)

    # Procesar el resultado del escaneo
    if scan_result[file_path][0] == 'OK':
        print(f"El archivo {file_path} es seguro.")
    else:
        print(f"El archivo {file_path} contiene malware: {scan_result[file_path][1]}")

if __name__ == '__main__':
    # Escanear un archivo espec√≠fico
    scan_file('/ruta/al/archivo/malicioso')
